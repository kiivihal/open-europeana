<?xml version="1.0" encoding="UTF-8"?>
	<!--
		~ Copyright 2007 EDL FOUNDATION ~ ~ Licensed under the EUPL, Version
		1.1 orÂ– as soon they ~ will be approved by the European Commission -
		subsequent ~ versions of the EUPL (the "Licence"); ~ you may not use
		this work except in compliance with the ~ Licence. ~ You may obtain a
		copy of the Licence at: ~ ~ http://ec.europa.eu/idabc/eupl ~ ~ Unless
		required by applicable law or agreed to in ~ writing, software
		distributed under the Licence is ~ distributed on an "AS IS" BASIS, ~
		WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either ~ express or
		implied. ~ See the Licence for the specific language governing ~
		permissions and limitations under the Licence.
	-->

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:tx="http://www.springframework.org/schema/tx"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
                http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

	<context:annotation-config />

	<!-- WURFLModel -->
	<bean id="wurflModel" class="net.sourceforge.wurfl.core.resource.DefaultWURFLModel">
		<constructor-arg index="0">
			<bean class="net.sourceforge.wurfl.core.resource.SpringXMLResource">
				<constructor-arg index="0" value="/wurfl.zip" />
			</bean>
		</constructor-arg>
		<constructor-arg index="1">
			<bean class="net.sourceforge.wurfl.core.resource.WURFLResources">
				<constructor-arg>
					<list>
						<bean class="net.sourceforge.wurfl.core.resource.SpringXMLResource">
							<constructor-arg value="/web_browsers_patch.xml" />
						</bean>
					</list>
				</constructor-arg>
			</bean>
		</constructor-arg>
	</bean>

	<!-- Handlers, Filters and Matchers -->
	<bean id="matcherManager"
		class="net.sourceforge.wurfl.core.handlers.matchers.MatcherManager">
		<constructor-arg ref="wurflModel" />
	</bean>

	<!-- Device -->
	<bean id="deviceProvider" class="net.sourceforge.wurfl.core.DefaultDeviceProvider">
		<constructor-arg ref="wurflModel" />
	</bean>

	<!-- Service -->
	<bean id="wurflService" class="net.sourceforge.wurfl.core.DefaultWURFLService">
		<constructor-arg ref="matcherManager" />
		<constructor-arg ref="deviceProvider" />
	</bean>

	<!-- WURFL Manager -->
	<bean id="wurflManager" class="net.sourceforge.wurfl.core.DefaultWURFLManager">
		<constructor-arg ref="wurflService" />
	</bean>

	<!-- WURFL Utils -->
	<bean id="wurflUtils" class="net.sourceforge.wurfl.core.WURFLUtils">
		<constructor-arg ref="wurflModel" />
	</bean>

	<!-- WURFL Holder -->
	<bean id="wurflHolder" class="net.sourceforge.wurfl.core.DefaultWURFLHolder">
		<constructor-arg ref="wurflManager" />
		<constructor-arg ref="wurflUtils" />
	</bean>

	<!-- Put WURFL Holder in ServletContext -->
	<bean
		class="org.springframework.web.context.support.ServletContextAttributeExporter">
		<property name="attributes">
			<map>
				<entry key="net.sourceforge.wurfl.core.WURFLHolder" value-ref="wurflHolder" />
			</map>
		</property>
	</bean>

	<bean id="deviceRecognition" class="de.offis.europeana.mobile.DeviceRecognition">
		<property name="context">
			<bean id="servletContext"
				class="org.springframework.web.context.support.ServletContextFactoryBean" />
		</property>
	</bean>

</beans>
